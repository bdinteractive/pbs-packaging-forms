<!DOCTYPE html>
<html>
<head>
  <title>PBS Packaging Forms</title>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">

  <script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
	<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>

</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1>PBS Packaging Forms</h1>
      </div>
    </div>
    <div clas="row">
      <div class="col-md-12" style="padding: 20px 0 40px">
        <button type="button" id="button" class="btn btn-primary">Preform Copy</button>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <table id="packagingForm" class="display" style="width:100%">
          <thead>
            <tr>
              <th>Select All</th>
              <th>Package ID</th>
              <th>Package Title</th>
              <th>NOLA Code</th>
              <th>Date Revised</th>
              <th>Copy UCC</th>
              <th>Copy OAC</th>
              <th>Copy IWT</th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function() {
      console.log("App Loaded!!!");
      var table = $('#packagingForm').DataTable({
        ajax: './data/forms.json',
        columns: [
          {
            data:   "all",
            render: function ( data, type, row ) {
              if ( type === 'display' ) {
                return '<input type="checkbox" data-data="'+data+'" value="ALL" class="pbs-check editor-active">';
              }
              return data;
            },
            className: "dt-body-center"
          },
          { data: "id" },
          { data: "title" },
          { data: "nola_code" },
          { data: "revise_date" },
          {
            data:   "UCC",
            render: function ( data, type, row ) {
              if ( type === 'display' ) {
                return '<input type="checkbox" data-data="'+data+'" value="UCC" class="pbs-check editor-active">';
              }
              return data;
            },
            className: "dt-body-center"
          },
          {
            data:   "OAC",
            render: function ( data, type, row ) {
              if ( type === 'display' ) {
                return '<input type="checkbox" data-data="'+data+'" value="OAC" class=" pbs-checkeditor-active">';
              }
              return data;
            },
            className: "dt-body-center"
          },
          {
            data:   "IWT",
            render: function ( data, type, row ) {
              if ( type === 'display' ) {
                return '<input type="checkbox" data-data="'+data+'" value="IWT" class="pbs-check editor-active">';
              }
              return data;
            },
            className: "dt-body-center"
          }
        ],
      });
      var copiedData = [];
      $('#button').on('click', function(e){
        var form = this;
        var params = table.$('input');
        $.each(params, function(key, value){
          if(params[key].checked === true){
            // console.log(params[key]);
            // console.log(value.value);
            // console.log($(value).data("data"));
            var obj = {
              "value": value.value,
              "data": $(value).data("data")
            };
            copiedData.push(obj);
          }
        });
        if(copiedData.length > 0){
          console.log("Data Array to send to endpoint: ", copiedData);
        } else {
          console.log("Nothing Selected");
        }
      });
    });
  </script>
</body>

</html>